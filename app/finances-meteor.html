<head>
  <title>finances-meteor</title>
  <!-- <meta name="viewport" content="user-scalable=no, initial-scale=1.0" /> -->
  <meta name="viewport" content="user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
</head>

<body>
</body>

<template name='home'>
  <div id='home' class='center page'>
    <p>
      Welcome! Are you
    </p>
    <ul>
      <li>Owed money?</li>
      <li>Owing money?</li>
      <li>All the above?</li>
    </ul>
    <p>And wanting to end this situation as quickly and painlessly as possible?</p>
    <p>While this app won't make money magically appear in people's bank accounts (slated for version 2.0), it will tell you the simplest way to transfer funds so that everyone gets what they're owed. Or it can be used to make sure you did if fairly if you've already done the divvying.</p> 
    <p>Did I mention it's easy and free?</p>
    <div class='call-to-action-row'>
      <a data-start-button type=button class='center'>Get Started!</a>
    </div>
  </div>
</template>

<template name='global-menu'>
  <div id='global-menu' class='clearfix'>
      <a data-reset-button type=button class="pull-left" title='Clear all data and start over'>reset &times;</a>
      <p data-flash-message class='pull-left'>{{message}}</p>
      <a data-next-button type=button class='pull-right {{#if nextButtonDisabled}}disabled{{/if}}'>next &gt;</a>
      <a data-up-button type=button class='pull-right {{#if upButtonDisabled}}disabled{{/if}}'>up ^</a>
    </div>
  </div> 
</template>

<template name="account-form">
  {{> global-menu}}
  <form id='account-form' class='center page'>
    <h1>Who's involved?</h1>
    <ul>
      <li>
        <input type='text' placeholder='Name' value="{{name}}" data-input=account tabindex=0><a type='button' data-add-button data-item='{{name}}'>&check;</a>
      </li>
    {{#each accounts}}
    <li>
      <a data-link data-account='{{_id}}'>{{name}}</a><a type='button' data-remove-button data-account='{{_id}}'>&times;</a>
    </li>
    {{/each}}
    </ul>
  </form>
</template>

<template name="item-form">
  {{> global-menu}}
  <form id='item-form' class='center page'>
    <h1>What's involved?</h1>
    <ul>
      <li>
      <input type='text' placeholder='Name' value="{{name}}" data-input=name tabindex=2><input type='number' placeholder='$$$' value="{{amount}}" data-input=amount min=0 tabindex=3><a type='button' data-add-button data-item='{{name}}'>&check;</a>
      </li>
    {{#each items}}
    <li>
    <a data-link data-item='{{_id}}' href='#'>{{name}}<span class='pull-right'>${{amount}}</span></a></a><a type='button' data-remove-button data-item='{{_id}}' href='#'>&times;</a>
    </li>
    {{/each}}
    </ul>
  </form>
</template>

<template name='item-detail-form'>
  {{> global-menu}}
  <form id='item-detail-form' class='center page'>
    {{#if account}}
    <h1>Fill in the blank. {{account.name}} _____ {{item.name}}.</h1>
    {{/if}}
    {{#unless account}}
    <h1>Looks like we're done here!</h1>
    {{/unless}}
    <a data-use-drop-zone type=button>used</a><a data-pay-drop-zone type=button>used &amp; paid for</a><a data-pay-drop-zone type=button>paid for</a><a data-pay-drop-zone type=button>had nothing to do with</a>
    <h1>The story of {{item.name}}:</h1>
    <ul data-story>
      {{#each users}}
      <li><a data-story-item data-link>{{name}} used {{item.name}}</a><a data-remove-button type=button>&times;</a></li>
      {{/each}}
      {{#each payers}}
      <li><a data-story-item data-link>{{name}} paid for {{item.name}}</a><a data-remove-button type=button>&times;</a></li>
      {{/each}}
    </ul>
  </form>
</template>

<template name='results'>
  {{> global-menu }}
  <div id='results' class='center page'>
    <h1>...And, done!</h1>
    <h1>What happened:</h1>
    <ol>
      {{#each externalPayments}}
      <li>{{fromAccount.name}} paid ${{amount}} for {{item.name}}</li>
      {{/each}}
      {{#each usages}}
      <li>{{fromAccount.name}} used {{item.name}}</li>
      {{/each}}
    </ol>
    <h1>What needs to happen:</h1>
    <ol>
      {{#each unsettledPayments}}
      <li>{{fromAccount.name}} should pay ${{amount}} to {{toAccount.name}}</li>
      {{/each}}
      {{#unless unsettledPayments}}
      <li>Nothing! You're already even!</li>
      {{/unless}}
    </ol>
  </div>
</template>
